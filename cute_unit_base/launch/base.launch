<?xml version="1.0"?>
<launch>
  <arg name="log_type" default="screen"/>

  <arg name="marker_id" default="423" />
  <arg name="marker_size" default="0.05"/>

  <param name="robot_description" command="$(find xacro)/xacro --inorder $(find cute_unit_description)/urdf/cute_unit.urdf.xacro" />

  <!-- realsense -->
  <param name="stereo_module/emitter_enabled" value="1"/>
  <include file="$(find realsense2_camera)/launch/includes/nodelet.launch.xml">
    <arg name="tf_prefix" value="camera"/>
    <arg name="initial_reset" value="true"/>
    <arg name="enable_sync" value="true"/>
    <arg name="enable_depth" value="true"/>
    <arg name="align_depth" value="true"/>
  </include>

  <node pkg="aruco_ros" type="single" name="aruco_marker_detect_node" output="$(arg log_type)">
    <remap from="/camera_info" to="/color/camera_info" />
    <remap from="/image" to="/color/image_raw" />
    <param name="image_is_rectified" value="True" />
    <param name="marker_id" value="$(arg marker_id)" />
    <param name="marker_size" value="$(arg marker_size)" />
    <param name="reference_frame"    value="" />
    <param name="camera_frame"       value="camera_color_optical_frame" />
    <param name="marker_frame"       value="marker_423" />
    <param name="corner_refinement"  value="LINES" />
  </node>

  <node name="robot_state_publisher" pkg="robot_state_publisher" type="state_publisher" output="$(arg log_type)" />

  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find cute_unit_viz)/viz/view.rviz" output="$(arg log_type)" />
</launch>
